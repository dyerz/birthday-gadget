<?xml version="1.0" encoding="UTF-8"?>
<Module>
<ModulePrefs title="__UP_title__"
  directory_title="__MSG_title__"
  description="__MSG_description__"
  screenshot="http://birthday-gadget.googlecode.com/svn/trunk/screenshot.png"
  thumbnail="http://birthday-gadget.googlecode.com/svn/trunk/thumbnail.png"
  author="Adam"
  author_email="birthdaygadget@gmail.com"
  height="200">
    <Locale messages="http://birthday-gadget.googlecode.com/svn/trunk/new/bd_content/ALL_ALL.xml" />
    <Require feature="idi" /> 
    <Require feature="locked-domain" /> 
    <Require feature="analytics" /> 
    <Require feature="dynamic-height" />
    <Require feature="setprefs"/>
</ModulePrefs>
<UserPref name="title" display_name="__MSG_titleName__" default_value="__MSG_title__" />
<UserPref name="birthdays" datatype="hidden" default_value="" /> 
<UserPref name="dateFormat" display_name="__MSG_formatName__" default_value="0" datatype="enum" >
  <EnumValue value="0" display_value="MMM DD" />
  <EnumValue value="1" display_value="DD MMM" />
  <EnumValue value="2" display_value="MM/DD" />
  <EnumValue value="3" display_value="DD/MM" />
</UserPref>
<UserPref name="showBDay" display_name="__MSG_showName__" default_value="5" datatype="enum" >
  <EnumValue value="1" />
  <EnumValue value="2" />
  <EnumValue value="3" />
  <EnumValue value="4" />
  <EnumValue value="5" />
  <EnumValue value="6" />
  <EnumValue value="7" />
  <EnumValue value="8" />
  <EnumValue value="9" />
  <EnumValue value="10" />
  <EnumValue value="20" />
  <EnumValue value="0" display_value="All" />
</UserPref>
<UserPref name="warnForward" display_name="__MSG_futureNoticeName__" default_value="7" datatype="enum" >
  <EnumValue value="3" />
  <EnumValue value="7" />
  <EnumValue value="10" />
  <EnumValue value="14" />
  <EnumValue value="21" />
  <EnumValue value="30" />
  <EnumValue value="60" />
  <EnumValue value="90" /> 
  <EnumValue value="0" display_value="All" /> 
</UserPref>
<UserPref name="warnPast" display_name="__MSG_pastNoticeName__" default_value="0" datatype="enum" >
  <EnumValue value="0" display_value="None"/>
  <EnumValue value="3" />
  <EnumValue value="7" />
  <EnumValue value="10" />
  <EnumValue value="14" />
</UserPref>
<UserPref name="showAge" display_name="__MSG_showAge__" default_value="true" datatype="bool" />
<UserPref name="showDays" display_name="__MSG_showDays__" default_value="false" datatype="bool" />
<UserPref name="showZodiac" display_name="__MSG_showZodiac__" default_value="false" datatype="bool" />
<UserPref name="_table_query_url" datatype="hidden" /> 
<UserPref name="tbVis" default_value="true" datatype="hidden" /> 
<UserPref name="debugMe" default_value="true" datatype="bool" /> 

<Content type="html">
<![CDATA[ 
<style>
	/* Toolbar CSS */
	#toolbar{
		height: 12px;
		text-align: center;
		margin: 0; padding: 0; 
		width: 100%;
	}

	#toolbar table{
		border-collapse: collapse; 
		padding: 0; margin: 0;
		text-align: center;
		width: 100%;
	}

	#toolbar img{
		position: absolute; 
		top: 2px; left: 0; 
		border: 0;
	}

	#toolbar td{
		padding: 0; margin: 0;
		font-size: 10px;
	}

	#tbConfig{
		width: 20%;
		text-align: left;
		color: #0000FF;
		text-decoration: underline;
		cursor: pointer;
	}
	
	#tbConvert{
		width: 30%;
		color: #FF0000;
		text-decoration: underline;
		cursor: pointer;
	}

	#tbRefresh{
		width: 20%;
		cursor: pointer;
		color: #0000FF;
		text-decoration: underline;
		text-align: right;
	}
	
	/* Toolbar Vis CSS */
	#toolbarVis{
		margin: 6px 0 0 0; padding: 0;
		width: 100%;
		height: 3px;
		background-color: #666666;
		cursor: n-resize;
		text-align: center;
	}
	
	#toolbarVis img{
		border: none;
		margin: 0 auto;
		padding: 0;
	}
	
	#upImg{
		position: relative; top: -5px;
	}

	#dnImg{
		position: relative; bottom: -5px;
	}	

	/* Table Div CSS */
	#tablediv{
		width: 100%; 
		margin: 10px 0 0 0; padding: 0;
		font-size: 11px;
	}
	
	#tablediv table {
		border-collapse: collapse; 
		width: 100%;
	}

	#tablediv td {
		padding: 2px;
		font-size: 11px;
		text-align: center;
	}

	.colid {
		font-weight: bold;
		border-bottom: 1px solid #000000;
		text-align: center;
	}
	
	/* Misc CSS */
	h1{
		font-size: 22px;
		text-align: center;
	}
	
	.error{
		color: #FF0000;
	}
	
	#oldtxt{
		width: 100%;
		height: 100px;
	}
</style>
<script src="http://www.google.com/jsapi" type="text/javascript"></script>
<div id="toolbar" style="display: none;"></div>
<div id="toolbarVis">
<img id="upImg" style="display: none;" src="http://birthday-gadget.googlecode.com/svn/trunk/new/bd_content/up.png" height="4" width="12" />
<img id="dnImg" style="display: none;" src="http://birthday-gadget.googlecode.com/svn/trunk/new/bd_content/dn.png" height="4" width="12" />
</div>
<div id="tablediv" >Loading...</div>
<div id="COLORPICKER201" class="COLORPICKER201"></div>

<script>
    google.load("visualization", "1"); // Load the Google Visualization API
    var gadgetHelper = null;
	var prefs__MODULE_ID__,
		dateStyle__MODULE_ID__,
		numVis__MODULE_ID__,
		futureNotice__MODULE_ID__,
		pastNotice__MODULE_ID__,
		showAge__MODULE_ID__,
		showDays__MODULE_ID__,
		showZodiac__MODULE_ID__,
		urlPref__MODULE_ID__,
		oldbd__MODULE_ID__,
		tbVis__MODULE_ID__;
    
    function init(){
		prefs__MODULE_ID__ = new _IG_Prefs();

		//temp data check!!!
		//******************************************************************************
		if(prefs__MODULE_ID__.getBool("debugMe")){
			prefs__MODULE_ID__.set("birthdays", '1953/01/25; Name\n2006/02/26;Madi\n1985/04/26;Test\n1989/04/27;broken?\n2001/05/25; Safe\n2007/05/25; Some Date\n1950/06/01; Test\n1954/06/05; Test\n1980/06/11; Test1\n1980/06/12; Test1\n1980/06/13; Test1\n1980/07/01; Test4\n1975/10/15;Test\n1987/11/13;Weston');
			prefs__MODULE_ID__.set("debugMe", false);
			prefs__MODULE_ID__ = new _IG_Prefs();
		}
		//******************************************************************************

		//get prefs
		dateStyle__MODULE_ID__=prefs__MODULE_ID__.getInt("dateFormat");
		numVis__MODULE_ID__=prefs__MODULE_ID__.getInt("showBDay");
		futureNotice__MODULE_ID__=prefs__MODULE_ID__.getInt("warnForward");
		pastNotice__MODULE_ID__=prefs__MODULE_ID__.getInt("warnPast");
		showAge__MODULE_ID__=prefs__MODULE_ID__.getBool("showAge");
		showDays__MODULE_ID__=prefs__MODULE_ID__.getBool("showDays");
		showZodiac__MODULE_ID__=prefs__MODULE_ID__.getBool("showZodiac");
		urlPref__MODULE_ID__=prefs__MODULE_ID__.getString("_table_query_url");
		tbVis__MODULE_ID__=prefs__MODULE_ID__.getString("tbVis");
		oldbd__MODULE_ID__=prefs__MODULE_ID__.getString("birthdays");
		
		//queryurl check
		if(urlPref__MODULE_ID__=="") {showHelp(); return;}
		if(urlPref__MODULE_ID__.search(/tq\?/)==-1 && urlPref__MODULE_ID__.search(/ccc\?/)!=-1 ){
			urlPref__MODULE_ID__=urlPref__MODULE_ID__.replace(/ccc\?/, "tq?");
			if(urlPref__MODULE_ID__.search(/\&/)!=-1)
				urlPref__MODULE_ID__=urlPref__MODULE_ID__.substring(0, urlPref__MODULE_ID__.indexOf("&"));
			urlPref__MODULE_ID__=escapeHtml(urlPref__MODULE_ID__)
			prefs__MODULE_ID__.set("_table_query_url", urlPref__MODULE_ID__);
		}

		//toolbar creation
		buildToolbar();
		if(tbVis__MODULE_ID__=="false"){ flipTB(Array(true, true, false, false));}
		else {flipTB(Array(false, false, true, false));}

		//js event config
		_gel("tbConfig").onclick=function(){ _gel('tablediv').innerHTML ="Loading..."; goConfig();};
		if(oldbd__MODULE_ID__!="") _gel("tbConvert").onclick=function(){ _gel('tablediv').innerHTML ="Loading..."; goConvert();}
		_gel("tbRefresh").onclick=function(){ _gel('tablediv').innerHTML ="Loading..."; sendQuery();};
		_gel("toolbarVis").onclick=function(){
			tbVis__MODULE_ID__=tbVis__MODULE_ID__=="true"?"false":"true";
			prefs__MODULE_ID__.set("tbVis", tbVis__MODULE_ID__);
			flipTB(Array(true, true, true, true));};
		
		//init done.. show stuff
		sendQuery();
    }

	function flipTB(sh){
		_gel("toolbarVis").title=tbVis__MODULE_ID__=="false"?"Hide the Toolbar":"Show the Toolbar"
		if(sh[0]) _toggle(_gel("toolbar"));
		if(sh[1]) _toggle(_gel("upImg")); 
		if(sh[2]) _toggle(_gel("dnImg"));
		if(sh[3]) _IG_AdjustIFrameHeight();
	}
	
    function sendQuery(qCheck) {
		gadgetHelper = new google.visualization.GadgetHelper();
		var query=new google.visualization.Query(urlPref__MODULE_ID__);
		query.setQuery("select A, B format A 'yyyy/MM/dd'");
		query.send(handleQueryResponse);
    }

    function handleQueryResponse(response) {
		//if (!gadgetHelper.validateResponse(response)) { return; };
		if(response.isError()) {
			switch(response.getReasons()){
				case "access_denied":
					goError('Spreadsheet Access Denied.<br />Please log in to your Google account.'); break;
				case "timeout":
					goError('Server Timeout.<br />Please refresh the window to try again.'); break;
				default:
					goError('Unexpected Error');
			}
			return;
		}
		var data = response.getDataTable();
		var html = [], rowDate, dispAge=0, dispDate="", dispDays=0;

		//check for dates
		if(data.getColumnType(1)=="date"){
			goError('Please move the dates from column "B" to column "A"');
			return;
		}
		if(data.getColumnType(0)!="date"){
			goError('Please set the "Format" of colum A to "date"');
			return;
		}
		if(data.getNumberOfRows()==0 || data.getNumberOfColumns()==0){
			goError('No data was found in your spreadsheet');
			return;
		}
		
		var dataArray=buildArray(data);
		if(dataArray.length==0){
			html.push('__MSG_nobd1__ '+futureNotice__MODULE_ID__+' __MSG_nobd2__');
			_gel('tablediv').style.textAlign="center"; return;
		}

		html.push('<table cellpaddind="0" cellspacing="0">');

		// Header row for column Ids
		html.push('<tr><td class="colid">Date</td><td class="colid">Name</td>');
		if(showAge__MODULE_ID__) html.push('<td class="colid">Age</td>');
		if(showDays__MODULE_ID__) html.push('<td class="colid">Days Away</td>');
		if(showZodiac__MODULE_ID__) html.push('<td class="colid">Zodiac</td>');
		html.push('</tr>');

		dispLength=numVis__MODULE_ID__==0?dataArray.length:numVis__MODULE_ID__;
		var countDisp=0;

		// Add the data rows
		for (var row = 0; row < dataArray.length; row++) {
			var rowData=dataArray[row].split("~;~");
			rowDate=Date.parse(rowData[0]);
			dispDate=makeDate__MODULE_ID__(rowData[0]);
			dispAge=makeAge(rowDate);
			dispDays=makeDays(rowDate, rowData[2]);
			dispZodiac=makeZodiac(rowData[2]);

			html.push('<tr><td>'+dispDate+'</td><td>'+escapeHtml(rowData[1])+'</td>');
			if(showAge__MODULE_ID__) html.push('<td>'+dispAge+'</td>');
			if(showDays__MODULE_ID__) html.push('<td>'+dispDays+'</td>');
			if(showZodiac__MODULE_ID__) html.push('<td>'+dispZodiac+'</td>');
			html.push('</tr>');
			countDisp++;
			if(countDisp>=dispLength) break;
		}
		html.push('</table>');

		// Set the generated html into the container div.
		_gel('tablediv').innerHTML = html.join('');
		_IG_AdjustIFrameHeight();
    };

    function escapeHtml(text) {
		if (text == null) { return ''; }
		return text.replace(/&/g, '&amp;').
			replace(/</g, '&lt;').
			replace(/>/g, '&gt;').
			replace(/"/g, '&quot;');
    }
	
	function showHelp(){
		var html = [];
		html.push('<h1>Gadget Setup</h1>');
		html.push('<a href="http://docs.google.com/" target="_blank">Go here!</a>');
		html.push('<p>1) Create a new spreadsheet<br />2) Dates in Column "A" - Names in Column "B"<br />3)Save the spreadsheet<br />4) Copy address from the address bar<br />5) Paste the address below</p>');
		html.push('<p>For more complete instructions, <a href="http://birthday-gadget.googlecode.com/svn/trunk/new/faq.html" title="FAQ" target="_blank">Click Here</a></p>');
		html.push('<br /><input type="text" style="width: 100%" id="newurl" />');
		html.push('<br /><input type="button" value="Save" id="saveurl" />');
	
		_gel('tablediv').innerHTML = html.join('');
		_gel('saveurl').onclick=function(){
			urlPref__MODULE_ID__=escapeHtml(_gel('newurl').value)
			prefs__MODULE_ID__.set("_table_query_url", urlPref__MODULE_ID__);
			_gel('tablediv').innerHTML ="Loading...";
			sendQuery();}

		_IG_AdjustIFrameHeight();
	}
	
	function goConfig(){
		var html=[];
		html.push('<h1>Config</h1>');
		html.push('<table>');
		html.push('<tr><td colspan=2><a target="_blank" href="'+urlPref__MODULE_ID__.replace(/tq\?/, "ccc?")+'">Edit Spreadsheet</a></td></tr>'); 
		html.push('<tr><td>Text Color <input id="bgcSet" type="button" value="Set" /></td>');
		html.push('<td><input id="textDiv" type="text" value="" /> <span id="textSpan" style="width: 40px;">&nbsp</span></td></tr>'); 
		html.push('<tr><td>Background Color <input id="bgcSet" type="button" value="Set" /></td>');
		html.push('<td><input id="bgcDiv" type="text" value="" /> <span id="bgcSpan" style="width: 40px;">&nbsp</span></td></tr>'); 
		html.push('<tr><td>Font Size</td><td><input type="text" value="" /></td></tr>'); 
		html.push('<tr><td>Spreadsheet Url</td><td><input type="text" value="" /></td></tr>'); 
		html.push('<tr><td><input type="button" value="Back" /></td><td><input type="button" value="Save" /></td></tr>'); 
		html.push('</table>');
		_gel('tablediv').innerHTML = html.join('');	
		_gel('textSet').onclick()=function(){ showColorGrid2("textDiv","textSpan");}
		_gel('bgcSet').onclick()=function(){ showColorGrid2("bgcDiv","bgcSpan");}
		_IG_AdjustIFrameHeight();
	}
	
	function goConvert(){
		var html=[];
		html.push('<h1>Convert</h1><ol>');
		html.push('<li><a target="_blank" href="'+urlPref__MODULE_ID__.replace(/tq\?/, "ccc?")+'">Open your Google spreadsheet</a></li>');
		html.push('<li>Copy the text below.');
		html.push('<br /><textarea id="oldtxt">'+oldbd__MODULE_ID__.replace(/;/g, "\t")+'</textarea></li>');
		html.push('<li>Paste the text into the spreadsheet.</li><li>Clear the old data when you are done.');
		html.push('<br /><input type="button" value="Clear Old Data" id="clearOld" /></li></ol>');
		html.push('See <a href="http://birthday-gadget.googlecode.com/svn/trunk/new/faq.html" title="Help" target="_blank">the help website</a> for additional assistance.');
		_gel('tablediv').innerHTML = html.join('');		
		_gel('clearOld').onclick=function(){
			prefs__MODULE_ID__.set("birthdays","");
			oldbd__MODULE_ID__="";
			buildToolbar();
			sendQuery();
		}
		_IG_AdjustIFrameHeight();
	}
	
	function goError(errText){
		var moreErr=[];
		moreErr.push('<h1>Error</h1>');
		moreErr.push('<span class="error">'+errText+'</span>');
		moreErr.push('<br />See <a href="http://birthday-gadget.googlecode.com/svn/trunk/new/faq.html" title="Help" target="_blank">the help website</a> for additional assistance.');
		moreErr.push('<br />Click "Refresh" above after you have made the changes');
		_gel('tablediv').innerHTML = moreErr.join('');
		_IG_AdjustIFrameHeight();
	}
	
	function buildToolbar(){
		var html = [];
		html.push('<table><tr>');
		//html.push('<td id="tbEdit"><a target="_blank" href="'+urlPref__MODULE_ID__.replace(/tq\?/, "ccc?")+'">Edit</a></td>');
		html.push('<td id="tbConfig">Config</td>');
		if(oldbd__MODULE_ID__!="") html.push('<td id="tbConvert">Convert</td>');
		html.push('<td id="tbHelp"><a href="http://birthday-gadget.googlecode.com/svn/trunk/new/faq.html" title="FAQ" target="_blank">Help</a></td>');
		html.push('<td id="tbRefresh">Refresh</td>');
		html.push('</tr></table>');	
		_gel('toolbar').innerHTML = html.join('');
	}
	
	function buildArray(data){
		var dataArray=new Array();
		var dataDate, tempDate=new Date(), nowDate=new Date(), maxDate=new Date(), formatDate="", tempData;
		nowDate.setTime(nowDate.getTime()-pastNotice__MODULE_ID__*24*60*60*1000);
		maxDate.setTime(maxDate.getTime()+futureNotice__MODULE_ID__*24*60*60*1000);
		for(var row=0; row<data.getNumberOfRows(); row++){
			dataDate=data.getFormattedValue(row,0);
			if(dataDate=="") continue;
			tempData=Date.parse(dataDate);
			if(isNaN(tempData)) { alert("Date Error: Row Number "+row); continue;}
			tempDate.setTime(tempData);
			if(tempDate.getMonth()<nowDate.getMonth() ||
				(tempDate.getMonth()==nowDate.getMonth()&&tempDate.getDate()<nowDate.getDate()))
				tempDate.setFullYear(nowDate.getFullYear()+1);
			else tempDate.setFullYear(nowDate.getFullYear());
			if(tempDate.getTime()>maxDate.getTime() && futureNotice__MODULE_ID__!=0) continue;
			formatDate=tempDate.getFullYear()+"/"+(tempDate.getMonth()+1)+"/"+tempDate.getDate();
			dataArray.push(dataDate+"~;~"+data.getFormattedValue(row,1)+"~;~"+formatDate);
		}
		dataArray=dataArray.sort(sortDate__MODULE_ID__);
		return(dataArray);
	}

	function sortDate__MODULE_ID__(a, b){
		var aA=a.split("~;~"), bA=b.split("~;~");
		return Date.parse(aA[2])-Date.parse(bA[2]);
	}

	function makeZodiac(formatDate){
		var s=formatDate.split("/");
		s[1]=parseInt(s[1],10); s[2]=parseInt(s[2],10);
		switch(s[1]){
			case 1: return(s[2]<21?"Capricorn":"Aquarius");
			case 2: return(s[2]<19?"Aquarius":"Pisces");
			case 3: return(s[2]<21?"Pisces":"Aries");
			case 4: return(s[2]<21?"Aries":"Taurus");
			case 5: return(s[2]<22?"Taurus":"Gemini");
			case 6: return(s[2]<22?"Gemini":"Cancer");
			case 7: return(s[2]<23?"Cancer":"Leo");
			case 8: return(s[2]<22?"Leo":"Virgo");
			case 9: return(s[2]<24?"Virgo":"Libra");
			case 10: return(s[2]<24?"Libra":"Scorpio");
			case 11: return(s[2]<23?"Scorpio":"Sagittarius");
			case 12: return(s[2]<23?"Sagittarius":"Capricorn");
		}
	}
 
	function makeDays(rowDate, formatDate){
		var t=new Date(), d=new Date();
		d.setTime(Date.parse(t.getFullYear()+"/"+(t.getMonth()+1)+"/"+t.getDate()));
		return Math.round((Date.parse(formatDate)-d.getTime())/(24*60*60*1000));
	}
	
    function makeAge(rowDate){
		var d=new Date(), p=new Date();
		d.setTime(d.getTime()-pastNotice__MODULE_ID__*24*60*60*1000);
		p.setTime(rowDate); 
		var age=d.getFullYear()-p.getFullYear();
		if(d.getMonth()>p.getMonth()) age--;
		else if(d.getMonth()==p.getMonth() && d.getDate()>=p.getDate()) age--;
		return(age++);
	}
    
    function makeDate__MODULE_ID__(inDate){
		var month=new Array(12);
			month[0]="__MSG_ajan__";
			month[1]="__MSG_afeb__";
			month[2]="__MSG_amar__";
			month[3]="__MSG_aapr__";
			month[4]="__MSG_amay__";
			month[5]="__MSG_ajun__";
			month[6]="__MSG_ajul__";
			month[7]="__MSG_aaug__";
			month[8]="__MSG_asep__";
			month[9]="__MSG_aoct__";
			month[10]="__MSG_anov__";
			month[11]="__MSG_adec__";
		tempArr=inDate.split("/");
		if(tempArr.length==2) {m=tempArr[0]-1; d=parseInt(tempArr[1]);}
		else {var t=Date.parse(inDate); var b=new Date(); b.setTime(t); m=b.getMonth(); d=b.getDate();}
		var n=new Date(); if(n.getMonth()==m && n.getDate()==d ) return("__MSG_today__");
		switch(dateStyle__MODULE_ID__){
			case 0: return (month[m]+" "+d);
			case 1: return (d+" "+month[m]);
			case 2: return ((m+1)+"/"+d);
			case 3: return (d+"/"+(m+1));
		}
	}

	//*********************************************************************************//
	function getScrollY(){var scrOfX = 0,scrOfY=0;if(typeof(window.pageYOffset)=='number'){scrOfY=window.pageYOffset;scrOfX=window.pageXOffset;}else if(document.body&&(document.body.scrollLeft||document.body.scrollTop)){scrOfY=document.body.scrollTop;scrOfX=document.body.scrollLeft;}else if(document.documentElement&&(document.documentElement.scrollLeft||document.documentElement.scrollTop)){scrOfY=document.documentElement.scrollTop;scrOfX=document.documentElement.scrollLeft;}return scrOfY;}document.write("<style type='text/css'>.colorpicker201{visibility:hidden;display:none;position:absolute;background:#FFF;border:solid 1px #CCC;padding:4px;z-index:999;filter:progid:DXImageTransform.Microsoft.Shadow(color=#D0D0D0,direction=135);}.o5582brd{padding:0;width:12px;height:14px;border-bottom:solid 1px #DFDFDF;border-right:solid 1px #DFDFDF;}a.o5582n66,.o5582n66,.o5582n66a{font-family:arial,tahoma,sans-serif;text-decoration:underline;font-size:9px;color:#666;border:none;}.o5582n66,.o5582n66a{text-align:center;text-decoration:none;}a:hover.o5582n66{text-decoration:none;color:#FFA500;cursor:pointer;}.a01p3{padding:1px 4px 1px 2px;background:whitesmoke;border:solid 1px #DFDFDF;}</style>");function getTop2(){csBrHt=0;if(typeof(window.innerWidth)=='number'){csBrHt=window.innerHeight;}else if(document.documentElement&&(document.documentElement.clientWidth||document.documentElement.clientHeight)){csBrHt=document.documentElement.clientHeight;}else if(document.body&&(document.body.clientWidth||document.body.clientHeight)){csBrHt=document.body.clientHeight;}ctop=((csBrHt/2)-115)+getScrollY();return ctop;}var nocol1="&#78;&#79;&#32;&#67;&#79;&#76;&#79;&#82;",clos1="&#67;&#76;&#79;&#83;&#69;",tt2="&#70;&#82;&#69;&#69;&#45;&#67;&#79;&#76;&#79;&#82;&#45;&#80;&#73;&#67;&#75;&#69;&#82;&#46;&#67;&#79;&#77;",hm2="&#104;&#116;&#116;&#112;&#58;&#47;&#47;&#119;&#119;&#119;&#46;";hm2+=tt2;tt2="&#80;&#79;&#87;&#69;&#82;&#69;&#68;&#32;&#98;&#121;&#32;&#70;&#67;&#80;";function getLeft2(){var csBrWt=0;if(typeof(window.innerWidth)=='number'){csBrWt=window.innerWidth;}else if(document.documentElement&&(document.documentElement.clientWidth||document.documentElement.clientHeight)){csBrWt=document.documentElement.clientWidth;}else if(document.body&&(document.body.clientWidth||document.body.clientHeight)){csBrWt=document.body.clientWidth;}cleft=(csBrWt/2)-125;return cleft;}function setCCbldID2(objID,val){document.getElementById(objID).value=val;}function setCCbldSty2(objID,prop,val){switch(prop){case "bc":if(objID!='none'){document.getElementById(objID).style.backgroundColor=val;};break;case "vs":document.getElementById(objID).style.visibility=val;break;case "ds":document.getElementById(objID).style.display=val;break;case "tp":document.getElementById(objID).style.top=val;break;case "lf":document.getElementById(objID).style.left=val;break;}}function putOBJxColor2(OBjElem,Samp,pigMent){if(pigMent!='x'){setCCbldID2(OBjElem,pigMent);setCCbldSty2(Samp,'bc',pigMent);}setCCbldSty2('colorpicker201','vs','hidden');setCCbldSty2('colorpicker201','ds','none');}function showColorGrid2(OBjElem,Sam){var objX=new Array('00','33','66','99','CC','FF');var c=0;var z='"'+OBjElem+'","'+Sam+'",""';var xl='"'+OBjElem+'","'+Sam+'","x"';var mid='';mid+='<table bgcolor="#FFFFFF" border="0" cellpadding="0" cellspacing="0" style="border:solid 0px #F0F0F0;padding:2px;"><tr>';mid+="<td colspan='18' align='left' style='font-size:10px;background:#6666CC;color:#FFF;font-family:arial;'>&nbsp;Chromatic Selection Palette</td></tr><tr><td colspan='18' align='center' style='margin:0;padding:2px;height:12px;' ><input class='o5582n66' type='text' size='12' id='o5582n66' value='#FFFFFF'><input class='o5582n66a' type='text' size='2' style='width:14px;' id='o5582n66a' onclick='javascript:alert(\"click on selected swatch below...\");' value='' style='border:solid 1px #666;'>&nbsp;|&nbsp;<a class='o5582n66' href='javascript:onclick=putOBJxColor2("+z+")'><span class='a01p3'>"+nocol1+"</span></a>&nbsp;&nbsp;&nbsp;&nbsp;<a class='o5582n66' href='javascript:onclick=putOBJxColor2("+xl+")'><span class='a01p3'>"+clos1+"</span></a></td></tr><tr>";var br=1;for(o=0;o<6;o++){mid+='</tr><tr>';for(y=0;y<6;y++){if(y==3){mid+='</tr><tr>';}for(x=0;x<6;x++){var grid='';grid=objX[o]+objX[y]+objX[x];var b="'"+OBjElem+"', '"+Sam+"','#"+grid+"'";mid+='<td class="o5582brd" style="background-color:#'+grid+'"><a class="o5582n66"  href="javascript:onclick=putOBJxColor2('+b+');" onmouseover=javascript:document.getElementById("o5582n66").value="#'+grid+'";javascript:document.getElementById("o5582n66a").style.backgroundColor="#'+grid+'";  title="#'+grid+'"><div style="width:12px;height:14px;"></div></a></td>';c++;}}}mid+="</tr><tr><td colspan='18' align='right' style='padding:2px;border:solid 1px #FFF;background:#FFF;'><a href='"+hm2+"' style='color:#666;font-size:8px;font-family:arial;text-decoration:none;letter-spacing:1px;'>"+tt2+"</a></td></tr></table>";var ttop=getTop2();setCCbldSty2('colorpicker201','tp',ttop);document.getElementById('colorpicker201').style.left=getLeft2();setCCbldSty2('colorpicker201','vs','visible');setCCbldSty2('colorpicker201','ds','block');document.getElementById('colorpicker201').innerHTML=mid;}
	//*********************************************************************************//
	
	
	google.setOnLoadCallback(init);

</script>
]]> 
</Content>
</Module>
